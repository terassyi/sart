name: ci
on: [push, pull_request]

env:
  CARGO_TERM_COLOR: always

jobs:
  build:

    runs-on: ubuntu-latest


    steps:
    - uses: actions/setup-go@v4
      with:
        go-version: '>=1.17.0'
    - uses: actions/checkout@v3
    - name: Setup grpc
      run: make setup-grpc
    - name: Build
      run: make build
    - name: Fmt
      run: make fmt
    - name: setup-dev
      run: make setup-dev
    - name: Run unit tests
      run: make unit-test
    - name: Run integration test
      run: make integration-test
    - name: Run controller test
      run: make controller-test
